<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Firebase Setup - Loot Box App</title>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #0a0e1a 0%, #1a1f35 100%);
      color: #e2e8f0;
      min-height: 100vh;
      padding: 2rem;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
    }

    h1 {
      font-size: 2rem;
      margin-bottom: 1rem;
      background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .card {
      background: rgba(26, 31, 53, 0.6);
      border: 1px solid rgba(59, 130, 246, 0.2);
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 2rem;
    }

    .config-section {
      margin-bottom: 1.5rem;
    }

    label {
      display: block;
      font-size: 0.875rem;
      font-weight: 500;
      color: #cbd5e1;
      margin-bottom: 0.5rem;
    }

    input, textarea {
      width: 100%;
      padding: 0.75rem;
      font-size: 1rem;
      font-family: 'Courier New', monospace;
      color: #e2e8f0;
      background: rgba(15, 22, 36, 0.8);
      border: 2px solid rgba(59, 130, 246, 0.2);
      border-radius: 8px;
      outline: none;
    }

    input:focus, textarea:focus {
      border-color: #3b82f6;
      box-shadow: 0 0 20px rgba(59, 130, 246, 0.2);
    }

    textarea {
      font-size: 0.875rem;
      min-height: 120px;
      resize: vertical;
    }

    button {
      padding: 0.75rem 1.5rem;
      font-size: 1rem;
      font-weight: 600;
      color: #ffffff;
      background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.25s ease;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 16px rgba(30, 64, 175, 0.4);
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .success {
      color: #10b981;
      font-weight: 600;
    }

    .error {
      color: #ef4444;
      font-weight: 600;
    }

    .info {
      background: rgba(59, 130, 246, 0.1);
      border: 1px solid rgba(59, 130, 246, 0.3);
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 1.5rem;
      font-size: 0.875rem;
      color: #93c5fd;
    }

    .status {
      margin-top: 1rem;
      padding: 1rem;
      border-radius: 8px;
      background: rgba(15, 22, 36, 0.6);
    }

    .box-preview {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }

    .box-item {
      padding: 1rem;
      background: rgba(15, 22, 36, 0.6);
      border: 1px solid rgba(59, 130, 246, 0.2);
      border-radius: 8px;
      text-align: center;
    }

    .box-item img {
      width: 100%;
      height: 80px;
      object-fit: contain;
      margin-bottom: 0.5rem;
    }

    .box-item h4 {
      font-size: 0.875rem;
      margin-bottom: 0.25rem;
    }

    .box-item .price {
      font-size: 0.75rem;
      color: #f59e0b;
      font-weight: 600;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üî• Firebase Setup Helper</h1>
    <p style="margin-bottom: 2rem; color: #94a3b8;">This tool helps you configure Firebase and populate sample box data.</p>

    <!-- Step 1: Configure Firebase -->
    <div class="card">
      <h2 style="margin-bottom: 1rem;">Step 1: Configure Firebase</h2>
      <div class="info">
        Paste your Firebase config from the Firebase Console. <br>
        Get it from: Firebase Console ‚Üí Project Settings ‚Üí Your apps ‚Üí Config
      </div>

      <div class="config-section">
        <label>Paste Your Firebase Config (JSON)</label>
        <textarea id="configInput" placeholder='{
  "apiKey": "AIza...",
  "authDomain": "your-app.firebaseapp.com",
  "projectId": "your-project-id",
  "storageBucket": "your-app.appspot.com",
  "messagingSenderId": "123456789",
  "appId": "1:123456:web:abc123"
}'></textarea>
      </div>

      <button onclick="initializeFirebase()">Connect to Firebase</button>
      <div id="connectionStatus" class="status" style="display: none;"></div>
    </div>

    <!-- Step 2: Add Sample Data -->
    <div class="card" id="sampleDataSection" style="display: none;">
      <h2 style="margin-bottom: 1rem;">Step 2: Add Sample Box Data</h2>
      <div class="info">
        This will add seasonal and store boxes to your Firestore database for testing.
      </div>

      <div class="box-preview" id="sampleBoxes"></div>

      <button onclick="populateSampleData()" style="margin-top: 1rem;">Add Sample Boxes to Firestore</button>
      <div id="populateStatus" class="status" style="display: none;"></div>
    </div>

    <!-- Step 3: Next Steps -->
    <div class="card" id="nextStepsSection" style="display: none;">
      <h2 style="margin-bottom: 1rem;">‚úÖ Setup Complete!</h2>
      <div class="info">
        <p style="margin-bottom: 0.5rem;"><strong>Next steps:</strong></p>
        <ol style="margin-left: 1.5rem; line-height: 1.8;">
          <li>Copy your Firebase config to <code>loot-box-app-v2.html</code> (lines 213-220)</li>
          <li>Refresh your main app</li>
          <li>Check the "Seasonal" and "Store" tabs in the box selector</li>
          <li>Try purchasing a box skin!</li>
        </ol>
      </div>
    </div>
  </div>

  <script>
    let db = null;
    let firebaseInitialized = false;

    const SAMPLE_BOXES = {
      seasonal: [
        {
          id: 'valentine2024',
          name: "Valentine's Heart Box",
          source: 'seasonal',
          price: 0.99,
          imageUrl: './assets/images/boxes/premium/army_camo.png', // Using existing image for demo
          seasonalInfo: {
            label: "Valentine's",
            startDate: Date.now() - 86400000, // Started yesterday
            endDate: Date.now() + (7 * 86400000) // Ends in 7 days
          },
          active: true,
          createdAt: Date.now()
        },
        {
          id: 'halloween2024',
          name: 'Spooky Halloween Box',
          source: 'seasonal',
          price: 1.49,
          imageUrl: './assets/images/boxes/premium/blue_tron.png',
          seasonalInfo: {
            label: 'Halloween',
            startDate: Date.now() - 86400000,
            endDate: Date.now() + (14 * 86400000) // Ends in 14 days
          },
          active: true,
          createdAt: Date.now()
        }
      ],
      store: [
        {
          id: 'golden_treasure',
          name: 'Golden Treasure',
          source: 'store',
          price: 2.99,
          imageUrl: './assets/images/boxes/free/chest.png',
          seasonalInfo: null,
          active: true,
          createdAt: Date.now()
        },
        {
          id: 'cyber_elite',
          name: 'Cyber Elite Box',
          source: 'store',
          price: 1.99,
          imageUrl: './assets/images/boxes/premium/blue_tron.png',
          seasonalInfo: null,
          active: true,
          createdAt: Date.now()
        },
        {
          id: 'ancient_relic',
          name: 'Ancient Relic',
          source: 'store',
          price: 0.99,
          imageUrl: './assets/images/boxes/free/skull_bone.png',
          seasonalInfo: null,
          active: true,
          createdAt: Date.now()
        }
      ]
    };

    function initializeFirebase() {
      const configInput = document.getElementById('configInput').value;
      const statusEl = document.getElementById('connectionStatus');

      try {
        const config = JSON.parse(configInput);

        // Validate config
        if (!config.apiKey || !config.projectId) {
          throw new Error('Invalid Firebase config');
        }

        // Initialize Firebase
        firebase.initializeApp(config);
        db = firebase.firestore();
        firebaseInitialized = true;

        statusEl.style.display = 'block';
        statusEl.className = 'status success';
        statusEl.innerHTML = '‚úÖ Connected to Firebase successfully!';

        // Show sample data section
        document.getElementById('sampleDataSection').style.display = 'block';
        renderSampleBoxes();

      } catch (error) {
        statusEl.style.display = 'block';
        statusEl.className = 'status error';
        statusEl.innerHTML = `‚ùå Error: ${error.message}`;
      }
    }

    function renderSampleBoxes() {
      const container = document.getElementById('sampleBoxes');
      const allBoxes = [...SAMPLE_BOXES.seasonal, ...SAMPLE_BOXES.store];

      container.innerHTML = allBoxes.map(box => `
        <div class="box-item">
          <img src="${box.imageUrl}" alt="${box.name}" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22100%22 height=%22100%22><text x=%2250%%22 y=%2250%%22 font-size=%2240%22 text-anchor=%22middle%22 dy=%22.3em%22>üì¶</text></svg>'">
          <h4>${box.name}</h4>
          <div class="price">$${box.price}</div>
          <div style="font-size: 0.625rem; color: #64748b; margin-top: 0.25rem;">
            ${box.source === 'seasonal' ? box.seasonalInfo.label : 'Store'}
          </div>
        </div>
      `).join('');
    }

    async function populateSampleData() {
      if (!firebaseInitialized || !db) {
        alert('Please connect to Firebase first!');
        return;
      }

      const statusEl = document.getElementById('populateStatus');
      statusEl.style.display = 'block';
      statusEl.className = 'status';
      statusEl.innerHTML = '‚è≥ Adding sample boxes to Firestore...';

      try {
        const allBoxes = [...SAMPLE_BOXES.seasonal, ...SAMPLE_BOXES.store];
        let addedCount = 0;

        for (const box of allBoxes) {
          await db.collection('boxCatalog').doc(box.id).set(box);
          addedCount++;
        }

        statusEl.className = 'status success';
        statusEl.innerHTML = `‚úÖ Successfully added ${addedCount} sample boxes to Firestore!`;

        // Show next steps
        document.getElementById('nextStepsSection').style.display = 'block';

      } catch (error) {
        statusEl.className = 'status error';
        statusEl.innerHTML = `‚ùå Error: ${error.message}`;
        console.error('Error adding sample data:', error);
      }
    }
  </script>
</body>
</html>
